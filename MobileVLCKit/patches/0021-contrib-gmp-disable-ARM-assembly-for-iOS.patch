From e6c05836a97b244f7fd19da40927030c4b941d3d Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Felix=20Paul=20K=C3=BChne?= <fkuehne@videolan.org>
Date: Tue, 19 Nov 2013 22:02:38 +0100
Subject: [PATCH] contrib/gmp: disable ARM assembly for iOS

---
 contrib/src/gmp/disable-arm-assembly-on-ios.patch | 14 ++++++++++++++
 contrib/src/gmp/rules.mak                         |  3 +++
 2 files changed, 17 insertions(+)
 create mode 100644 contrib/src/gmp/disable-arm-assembly-on-ios.patch

diff --git a/contrib/src/gmp/disable-arm-assembly-on-ios.patch b/contrib/src/gmp/disable-arm-assembly-on-ios.patch
new file mode 100644
index 0000000..d47ce96
--- /dev/null
+++ b/contrib/src/gmp/disable-arm-assembly-on-ios.patch
@@ -0,0 +1,14 @@
+diff -ru gmp/configure.in gmp/configure.in
+--- gmp/configure.in	2013-11-19 22:00:53.000000000 +0100
++++ gmp/configure.in	2013-11-19 22:01:10.000000000 +0100
+@@ -523,6 +523,10 @@
+     path="cray"
+     ;;
+ 
++  arm*-apple-*)
++    path="generic"
++    gmp_asm_syntax_testing=no
++    ;;
+ 
+   arm*-*-*)
+     path="arm"
diff --git a/contrib/src/gmp/rules.mak b/contrib/src/gmp/rules.mak
index 5f60fb0..9c7a1b6 100644
--- a/contrib/src/gmp/rules.mak
+++ b/contrib/src/gmp/rules.mak
@@ -16,6 +16,9 @@ gmp: gmp-$(GMP_VERSION).tar.bz2 .sum-gmp
 	$(APPLY) $(SRC)/gmp/inline.diff
 	$(APPLY) $(SRC)/gmp/ansitest.diff
 	$(APPLY) $(SRC)/gmp/ansi2knr.diff
+ifdef HAVE_IOS
+	$(APPLY) $(SRC)/gmp/disable-arm-assembly-on-ios.patch
+endif
 	$(MOVE)
 
 .gmp: gmp
-- 
1.8.3.4 (Apple Git-47)

