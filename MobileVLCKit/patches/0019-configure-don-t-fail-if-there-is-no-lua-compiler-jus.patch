From a1d303613cb3942fbb47a5f76e1447819072196e Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Felix=20Paul=20K=C3=BChne?= <fkuehne@videolan.org>
Date: Fri, 20 Nov 2015 14:45:50 +0100
Subject: [PATCH 19/19] configure: don't fail if there is no lua compiler, just
 don't compile lua

---
 configure.ac      | 4 +---
 share/Makefile.am | 2 +-
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/configure.ac b/configure.ac
index 2a45941..696a5b7 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1545,13 +1545,11 @@ then
   fi
   AC_ARG_VAR([LUAC], [LUA byte compiler])
   AC_CHECK_PROGS(LUAC, [${LUAC} luac], [false])
-  AS_IF([test "${LUAC}" = "false"], [
-    AC_MSG_ERROR([Could not find the LUA byte compiler.])
-  ])
   AS_IF([test -d "${CONTRIB_DIR}" -a -f "${CONTRIB_DIR}/lib/liblua.a" -a `echo|${LUAC} -o - -|od -j 8 -N 2 -t x2|head -n 1|tr -s ' '|cut -d' ' -f2` != 0404], [
     AC_MSG_ERROR([You need 32-bits luac when using using lua from contrib.])
   ])
 fi
+AM_CONDITIONAL(COMPILE_LUA_BYTECODE, [test "${LUAC}" = "true"])
 AM_CONDITIONAL(BUILD_LUA, [test "${have_lua}" = "yes"])
 
 
diff --git a/share/Makefile.am b/share/Makefile.am
index 98f745f..77b4bf0 100644
--- a/share/Makefile.am
+++ b/share/Makefile.am
@@ -101,7 +101,7 @@ luac_verbose_0 = @echo "  LUAC   $@";
 	$(AM_V_at)mkdir -p "$$(dirname '$@')"
 	$(luac_verbose)$(LUAC) -o $@ $<
 
-if BUILD_LUA
+if COMPILE_LUA_BYTECODE
 nobase_vlclib_DATA = \
 	lua/extensions/VLSub.luac \
 	lua/intf/cli.luac \
-- 
2.6.0

