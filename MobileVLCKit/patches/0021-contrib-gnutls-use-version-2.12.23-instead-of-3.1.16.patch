From 68fbb7b754620327f2c577f253513e42e89c120b Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Felix=20Paul=20K=C3=BChne?= <fkuehne@videolan.org>
Date: Thu, 21 Nov 2013 02:36:43 +0100
Subject: [PATCH 21/23] contrib/gnutls: use version 2.12.23 instead of 3.1.16
 which still depends on gcrypt instead of nettle

---
 contrib/src/gnutls/SHA512SUMS |  2 +-
 contrib/src/gnutls/rules.mak  | 25 +++++++------------------
 2 files changed, 8 insertions(+), 19 deletions(-)

diff --git a/contrib/src/gnutls/SHA512SUMS b/contrib/src/gnutls/SHA512SUMS
index 67b664a..098d2ae 100644
--- a/contrib/src/gnutls/SHA512SUMS
+++ b/contrib/src/gnutls/SHA512SUMS
@@ -1 +1 @@
-ab6ab90966d1be767320f7c0aaea89cfd574391f82c4d602e8d73fec5f3b6bdee6032ea127f3d5fefd5db035ccabfb1ce34db0fdb87b0f451bd9d6f842195593  gnutls-3.1.17.tar.xz
+7780e9ca7b592350ce9b11e53a63d3212320402d8ad2462bfbc0e69aec4a48bb372a1925627abb7996535c87c90e3d79537ea118c8bb36d26aae8e19eaae3a06  gnutls-2.12.23.tar.bz2
diff --git a/contrib/src/gnutls/rules.mak b/contrib/src/gnutls/rules.mak
index f2d5c7a..0e3ffbb 100644
--- a/contrib/src/gnutls/rules.mak
+++ b/contrib/src/gnutls/rules.mak
@@ -1,32 +1,20 @@
 # GnuTLS
 
-GNUTLS_VERSION := 3.1.17
-GNUTLS_URL := ftp://ftp.gnutls.org/gcrypt/gnutls/v3.1/gnutls-$(GNUTLS_VERSION).tar.xz
+GNUTLS_VERSION := 2.12.23
+GNUTLS_URL := ftp://ftp.gnutls.org/gcrypt/gnutls/v2.12/gnutls-$(GNUTLS_VERSION).tar.bz2
 
 PKGS += gnutls
 ifeq ($(call need_pkg,"gnutls >= 3.0.20"),)
 PKGS_FOUND += gnutls
 endif
 
-$(TARBALLS)/gnutls-$(GNUTLS_VERSION).tar.xz:
+$(TARBALLS)/gnutls-$(GNUTLS_VERSION).tar.bz2:
 	$(call download,$(GNUTLS_URL))
 
-.sum-gnutls: gnutls-$(GNUTLS_VERSION).tar.xz
+.sum-gnutls: gnutls-$(GNUTLS_VERSION).tar.bz2
 
-gnutls: gnutls-$(GNUTLS_VERSION).tar.xz .sum-gnutls
+gnutls: gnutls-$(GNUTLS_VERSION).tar.bz2 .sum-gnutls
 	$(UNPACK)
-ifdef HAVE_WIN32
-	$(APPLY) $(SRC)/gnutls/gnutls-win32.patch
-endif
-ifdef HAVE_ANDROID
-	$(APPLY) $(SRC)/gnutls/no-create-time-h.patch
-endif
-	$(APPLY) $(SRC)/gnutls/gnutls-no-egd.patch
-	$(APPLY) $(SRC)/gnutls/read-file-limits.h.patch
-	$(APPLY) $(SRC)/gnutls/downgrade-automake-requirement.patch
-ifdef HAVE_MACOSX
-	$(APPLY) $(SRC)/gnutls/mac-keychain-lookup.patch
-endif
 	$(call pkg_static,"lib/gnutls.pc.in")
 	$(UPDATE_AUTOCONFIG)
 	$(MOVE)
@@ -43,9 +31,10 @@ GNUTLS_CONF := \
 	--disable-guile \
 	--disable-nls \
 	--without-libintl-prefix \
+	--with-libgcrypt \
 	$(HOSTCONF)
 
-DEPS_gnutls = nettle $(DEPS_nettle)
+DEPS_gnutls = gcrypt $(DEPS_gcrypt)
 
 .gnutls: gnutls
 ifndef HAVE_IOS
-- 
1.8.3.4 (Apple Git-47)

