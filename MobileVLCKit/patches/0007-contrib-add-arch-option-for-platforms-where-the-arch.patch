From 1760110420b7fdc31c08e60a44b9dee6071fd0ee Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Felix=20Paul=20K=C3=BChne?= <fkuehne@videolan.org>
Date: Thu, 3 Oct 2013 18:27:43 +0200
Subject: [PATCH 07/19] contrib: add arch option for platforms where the arch
 triplet would be ambigous

---
 contrib/bootstrap | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/contrib/bootstrap b/contrib/bootstrap
index 246e3d6..df7ab6e 100755
--- a/contrib/bootstrap
+++ b/contrib/bootstrap
@@ -31,6 +31,7 @@ usage()
 	echo "  --disable-sout   configure to not build stream output packages"
 	echo "  --enable-small   optimize libraries for size with slight speed decrease [DANGEROUS]"
 	echo "  --disable-gpl    configure to not build viral GPL code"
+	echo "  --arch=ARCH      configure to set the target architecture if host triple is ambigous"
 }
 
 BUILD=
@@ -42,6 +43,7 @@ BUILD_ENCODERS="1"
 BUILD_NETWORK="1"
 BUILD_DISCS="1"
 GPL="1"
+ARCH=
 
 if test ! -f "../../contrib/src/main.mak"
 then
@@ -86,6 +88,9 @@ do
 		--enable-*)
 			PKGS_ENABLE="${PKGS_ENABLE} ${1#--enable-}"
 			;;
+		--arch=*)
+			ARCH="${1#--arch=}"
+			;;
 		*)
 			echo "Unrecognized options $1"
 			usage
@@ -212,6 +217,7 @@ test -z "$BUILD_ENCODERS" || add_make_enabled "BUILD_ENCODERS"
 test -z "$BUILD_NETWORK" || add_make_enabled "BUILD_NETWORK"
 test -z "$ENABLE_SMALL" || add_make_enabled "ENABLE_SMALL"
 test -z "$GPL" || add_make_enabled "GPL"
+test -z "$ARCH" || add_make "ARCH := $ARCH"
 
 #
 # Checks
@@ -225,7 +231,10 @@ case "${OS}" in
 			add_make_enabled "HAVE_MACOSX" "HAVE_DARWIN_OS" "HAVE_BSD"
 		else
 			check_ios_sdk
-			add_make_enabled "HAVE_IOS" "HAVE_DARWIN_OS" "HAVE_BSD" "HAVE_NEON" "HAVE_ARMV7A"
+			add_make_enabled "HAVE_IOS" "HAVE_DARWIN_OS" "HAVE_BSD" "HAVE_NEON"
+ 			if [ "$ARCH" != "arm64" ]; then
+ 				add_make_enabled "HAVE_ARMV7A"
+ 			fi
 		fi
 		;;
 	*bsd*)
-- 
1.8.3.4 (Apple Git-47)

